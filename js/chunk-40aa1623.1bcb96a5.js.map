{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.date.to-string.js","webpack:///./src/views/user/profile.vue?e354","webpack:///src/views/user/profile.vue","webpack:///./src/views/user/profile.vue?3a96","webpack:///./src/views/user/profile.vue","webpack:///./node_modules/core-js/modules/es.function.name.js","webpack:///./src/api/user.js"],"names":["redefine","DatePrototype","Date","prototype","INVALID_DATE","TO_STRING","nativeDateToString","getTime","NaN","value","call","this","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","on","$event","$router","back","save","showPhoto","photo","slot","user","name","showName","gender","showGender","birthday","openDate","model","callback","$$v","expression","ref","staticStyle","preview","$refs","fileInput","click","$set","changeGender","showBirthday","minDate","dateShow","confirmDate","nowDate","staticRenderFns","data","methods","fileReader","readAsDataURL","file","onload","component","DESCRIPTORS","defineProperty","f","FunctionPrototype","Function","FunctionPrototypeToString","toString","nameRE","NAME","configurable","get","match","error","login","mobile","code","request","followed","userId","target","unFollowed","getUserInfo","getUserProfile","saveUserInfo","saveUserPhoto","fromData"],"mappings":"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","file":"js/chunk-40aa1623.1bcb96a5.js","sourcesContent":["var redefine = require('../internals/redefine');\n\nvar DatePrototype = Date.prototype;\nvar INVALID_DATE = 'Invalid Date';\nvar TO_STRING = 'toString';\nvar nativeDateToString = DatePrototype[TO_STRING];\nvar getTime = DatePrototype.getTime;\n\n// `Date.prototype.toString` method\n// https://tc39.github.io/ecma262/#sec-date.prototype.tostring\nif (new Date(NaN) + '' != INVALID_DATE) {\n  redefine(DatePrototype, TO_STRING, function toString() {\n    var value = getTime.call(this);\n    // eslint-disable-next-line no-self-compare\n    return value === value ? nativeDateToString.call(this) : INVALID_DATE;\n  });\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('van-nav-bar',{attrs:{\"left-arrow\":\"\",\"title\":\"编辑资料\",\"right-text\":\"保存\"},on:{\"click-left\":function($event){return _vm.$router.back()},\"click-right\":_vm.save}}),_c('van-cell-group',[_c('van-cell',{attrs:{\"is-link\":\"\",\"title\":\"头像\",\"center\":\"\"},on:{\"click\":function($event){_vm.showPhoto=true}}},[_c('van-image',{attrs:{\"slot\":\"default\",\"width\":\"1.5rem\",\"height\":\"1.5rem\",\"fit\":\"cover\",\"round\":\"\",\"src\":_vm.photo},slot:\"default\"})],1),_c('van-cell',{attrs:{\"is-link\":\"\",\"title\":\"名称\",\"value\":_vm.user.name},on:{\"click\":function($event){_vm.showName=true}}}),_c('van-cell',{attrs:{\"is-link\":\"\",\"title\":\"性别\",\"value\":_vm.user.gender===0?'男':'女'},on:{\"click\":function($event){_vm.showGender=true}}}),_c('van-cell',{attrs:{\"is-link\":\"\",\"title\":\"生日\",\"value\":_vm.user.birthday},on:{\"click\":function($event){return _vm.openDate()}}})],1),_c('van-popup',{attrs:{\"position\":\"bottom\"},model:{value:(_vm.showPhoto),callback:function ($$v) {_vm.showPhoto=$$v},expression:\"showPhoto\"}},[_c('input',{ref:\"fileInput\",staticStyle:{\"display\":\"none\"},attrs:{\"type\":\"file\"},on:{\"change\":_vm.preview}}),_c('van-cell',{attrs:{\"value\":\"本地相册选择\",\"is-link\":\"\"},on:{\"click\":function($event){return _vm.$refs.fileInput.click()}}}),_c('van-cell',{attrs:{\"value\":\"拍照\",\"is-link\":\"\"}})],1),_c('van-popup',{attrs:{\"position\":\"bottom\"},model:{value:(_vm.showName),callback:function ($$v) {_vm.showName=$$v},expression:\"showName\"}},[_c('van-field',{attrs:{\"required\":\"\",\"placeholder\":\"请输入用户名\"},model:{value:(_vm.user.name),callback:function ($$v) {_vm.$set(_vm.user, \"name\", $$v)},expression:\"user.name\"}})],1),_c('van-popup',{attrs:{\"position\":\"bottom\"},model:{value:(_vm.showGender),callback:function ($$v) {_vm.showGender=$$v},expression:\"showGender\"}},[_c('van-cell',{attrs:{\"value\":\"男\",\"is-link\":\"\"},on:{\"click\":function($event){return _vm.changeGender(0)}}}),_c('van-cell',{attrs:{\"value\":\"女\",\"is-link\":\"\"},on:{\"click\":function($event){return _vm.changeGender(1)}}})],1),_c('van-popup',{attrs:{\"position\":\"bottom\"},model:{value:(_vm.showBirthday),callback:function ($$v) {_vm.showBirthday=$$v},expression:\"showBirthday\"}},[_c('van-datetime-picker',{attrs:{\"title\":\"选择生日\",\"type\":\"date\",\"min-date\":_vm.minDate},on:{\"cancel\":function($event){_vm.dateShow=false},\"confirm\":_vm.confirmDate},model:{value:(_vm.nowDate),callback:function ($$v) {_vm.nowDate=$$v},expression:\"nowDate\"}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"container\">\r\n    <van-nav-bar\r\n      left-arrow\r\n      @click-left=\"$router.back()\"\r\n      title=\"编辑资料\"\r\n      @click-right=\"save\"\r\n      right-text=\"保存\"\r\n    ></van-nav-bar>\r\n    <van-cell-group>\r\n      <van-cell is-link title=\"头像\" @click=\"showPhoto=true\" center>\r\n        <van-image slot=\"default\" width=\"1.5rem\" height=\"1.5rem\" fit=\"cover\" round :src=\"photo\" />\r\n      </van-cell>\r\n      <van-cell is-link title=\"名称\" @click=\"showName=true\" :value=\"user.name\" />\r\n      <van-cell is-link title=\"性别\" @click=\"showGender=true\" :value=\"user.gender===0?'男':'女'\" />\r\n      <van-cell is-link title=\"生日\" @click=\"openDate()\" :value=\"user.birthday\" />\r\n    </van-cell-group>\r\n    <van-popup v-model=\"showPhoto\" position=\"bottom\">\r\n      <input type=\"file\" style=\"display:none\" ref=\"fileInput\" @change=\"preview\" />\r\n      <van-cell value=\"本地相册选择\" is-link @click=\"$refs.fileInput.click()\" />\r\n      <van-cell value=\"拍照\" is-link />\r\n    </van-popup>\r\n    <van-popup v-model=\"showName\" position=\"bottom\">\r\n      <van-field v-model=\"user.name\" required placeholder=\"请输入用户名\" />\r\n    </van-popup>\r\n    <van-popup v-model=\"showGender\" position=\"bottom\">\r\n      <van-cell value=\"男\" @click=\"changeGender(0)\" is-link />\r\n      <van-cell value=\"女\" @click=\"changeGender(1)\" is-link />\r\n    </van-popup>\r\n    <van-popup v-model=\"showBirthday\" position=\"bottom\">\r\n      <van-datetime-picker\r\n        title=\"选择生日\"\r\n        v-model=\"nowDate\"\r\n        type=\"date\"\r\n        :min-date=\"minDate\"\r\n        @cancel=\"dateShow=false\"\r\n        @confirm=\"confirmDate\"\r\n      />\r\n    </van-popup>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport dayjs from 'dayjs'\r\nimport { getUserProfile, saveUserInfo, saveUserPhoto } from '@/api/user'\r\nexport default {\r\n  name: 'user-profile',\r\n  data () {\r\n    return {\r\n      // 弹窗控制\r\n      showPhoto: false,\r\n      showName: false,\r\n      showGender: false,\r\n      showBirthday: false,\r\n      nowDate: new Date(),\r\n      minDate: new Date('1950-01-01'),\r\n      // 默认用户信息\r\n      photo: 'https://img.yzcdn.cn/vant/cat.jpeg',\r\n      user: {\r\n        name: '默认信息',\r\n        gender: 0,\r\n        birthday: '2019-10-10'\r\n      }\r\n    }\r\n  },\r\n  async created () {\r\n    const data = await getUserProfile()\r\n    this.photo = data.photo\r\n    this.user = data\r\n  },\r\n  methods: {\r\n    openDate () {\r\n      // 有生日数据\r\n      if (this.user.birthday) {\r\n        this.nowDate = new Date(this.user.birthday)\r\n      }\r\n      this.showBirthday = true\r\n    },\r\n    confirmDate (value) {\r\n      // 确认时间后  把Date转换成String\r\n      this.user.birthday = dayjs(value).format('YYYY-MM-DD')\r\n      this.showBirthday = false\r\n    },\r\n    changeGender (gender) {\r\n      // 选择性别 gender 0 男  1 女\r\n      this.user.gender = gender\r\n      this.showGender = false\r\n    },\r\n    // 预览头像\r\n    preview () {\r\n      const file = this.$refs.fileInput.files[0]\r\n      const fileReader = new FileReader()\r\n      fileReader.readAsDataURL(file)\r\n      fileReader.onload = () => {\r\n        this.photo = fileReader.result\r\n        this.showPhoto = false\r\n      }\r\n    },\r\n    // 保存信息\r\n    async save () {\r\n      // 保存头像\r\n      try {\r\n        // 上传头像\r\n        const formData = new FormData()\r\n        formData.append('photo', this.$refs.fileInput.files[0])\r\n        await saveUserPhoto(formData)\r\n        // 保存信息\r\n        const { name, gender, birthday } = this.user\r\n        await saveUserInfo(name, gender, birthday)\r\n        this.$toast.success('保存成功')\r\n      } catch (error) {\r\n        this.$toast.fail('保存失败')\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./profile.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./profile.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./profile.vue?vue&type=template&id=b63afe90&\"\nimport script from \"./profile.vue?vue&type=script&lang=js&\"\nexport * from \"./profile.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var DESCRIPTORS = require('../internals/descriptors');\nvar defineProperty = require('../internals/object-define-property').f;\n\nvar FunctionPrototype = Function.prototype;\nvar FunctionPrototypeToString = FunctionPrototype.toString;\nvar nameRE = /^\\s*function ([^ (]*)/;\nvar NAME = 'name';\n\n// Function instances `.name` property\n// https://tc39.github.io/ecma262/#sec-function-instances-name\nif (DESCRIPTORS && !(NAME in FunctionPrototype)) {\n  defineProperty(FunctionPrototype, NAME, {\n    configurable: true,\n    get: function () {\n      try {\n        return FunctionPrototypeToString.call(this).match(nameRE)[1];\n      } catch (error) {\n        return '';\n      }\n    }\n  });\n}\n","import request from '@/utils/request'\r\n/**\r\n * 登录\r\n * @param {String} mobile - 手机号\r\n * @param {String} code - 验证码\r\n */\r\nexport const login = ({\r\n  mobile,\r\n  code\r\n}) => {\r\n  return request('/app/v1_0/authorizations', 'post', {\r\n    mobile,\r\n    code\r\n  })\r\n}\r\n/**\r\n * 关注\r\n * @param {Integer} userId - 作者ID 用户ID\r\n */\r\nexport const followed = (userId) => {\r\n  return request('/app/v1_0/user/followings', 'post', { target: userId })\r\n}\r\n/**\r\n * 取消关注\r\n * @param {Integer} userId - 作者ID 用户ID\r\n */\r\nexport const unFollowed = (userId) => {\r\n  return request(`/app/v1_0/user/followings/${userId}`, 'delete')\r\n}\r\n/**\r\n * 获取个人中心  用户信息\r\n */\r\nexport const getUserInfo = () => {\r\n  return request('/app/v1_0/user', 'get')\r\n}\r\n/**\r\n * 获取个人中心编辑用户资料信息\r\n */\r\nexport const getUserProfile = () => {\r\n  return request(`/app/v1_0/user/profile`, 'get')\r\n}\r\n/**\r\n * 编辑用户个人资料（保存信息）\r\n * @param {string} name 昵称\r\n * @param {integer} gender 性别，0-男，1-女\r\n * @param {string} birthday 生日，格式'2018-12-20'\r\n */\r\nexport const saveUserInfo = (name, gender, birthday) => {\r\n  return request('/app/v1_0/user/profile', 'PATCH', { name, gender, birthday })\r\n}\r\n/**\r\n * 编辑用户照片资料（头像、身份证照片）\r\n * @param {FromData} fromData - 提交文件  key的值photo\r\n */\r\nexport const saveUserPhoto = (fromData) => {\r\n  return request('/app/v1_0/user/photo', 'PATCH', fromData)\r\n}\r\n"],"sourceRoot":""}